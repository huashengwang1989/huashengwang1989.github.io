<html>
<!-- Head tag -->
  <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <title>Kasei's Blog</title>
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link rel="stylesheet" href="/css/ie10-viewport-bug-workaround.css">
    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="/css/blog.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->


    <script src="https://use.typekit.net/xdq4yde.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>
    
<link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


<!-- get screen size -->


  <body>
      <div id="mobile-hidden-panel" class="collapse">
        <div class="hidden-pannel-wrapper">
            <div class="sidebar-module sidebar-widgets">
  
    
    
    <div class="widget-wrapper about-widget">

        <div class="widget-container">
          <div class="flex-item-wrapper">
            <div class="profile-wrapper">
              <div class="profile-image">
                <img src = '/images/profile.png' alt = "profile picture">
              </div>
            </div>
          </div>
          <div class="flex-item-wrapper">
            <p class="description">我が名はカセイ</p>
            <hr>
           <div class="location-wrapper">
             <p class="location"><span class="glyphicon glyphicon-map-marker"></span> Singapore</p>
           </div>
           <hr>
           <div class="social-wrapper">
             
             <a href="https://github.com/huashengwang1989/" target="_blank">
              <svg class="glyphicon glyphicon-ant-github" alt="GitHub Icon" ><use xlink:href="/icon/ant-github.svg#si-ant-github"></use></svg>
            </a>
            
           </div>
         </div>
       </div>

    </div>

  
    
    
    <div class="widget-wrapper menu-widget">

        <div class="widget-container">
          <div class="menu-wrapper">
            <nav class="nav">
                
                    <div class="nav-item">
                      <a href="/">Home</a>
                    </div>
                
                    <div class="nav-item">
                      <a href="/archives">Archives</a>
                    </div>
                
            </nav>
          </div>
         </div>
    </div>

  
    
    

  
</div>

        </div>
      </div>
      <div id="wrapper">
        <div id="mobile-header-wrapper">
          <nav class="header-nav">
  
    <div class="widget-wrapper menu-widget">

        <div class="widget-container">
          <div class="menu-wrapper">
            <nav class="nav">
                
                    <div class="nav-item">
                      <a href="/">Home</a>
                    </div>
                
                    <div class="nav-item">
                      <a href="/archives">Archives</a>
                    </div>
                
            </nav>
          </div>
         </div>
    </div>

  <div class="nav-profile-wrapper">
    <div class="nav-profile-image">
      <a class="nav-profile-toggle-button" data-toggle="collapse" data-target="#mobile-hidden-panel">
        <img src = '/images/profile.png' alt = "profile picture">
      </a>
    </div>
  </div>
</nav>

        </div>
        <div id="container">

            <!-- Sidebar -->

          <div id="sidebar-wrapper">
              <div class="sidebar-module sidebar-widgets">
  
    
    
    <div class="widget-wrapper about-widget">

        <div class="widget-container">
          <div class="flex-item-wrapper">
            <div class="profile-wrapper">
              <div class="profile-image">
                <img src = '/images/profile.png' alt = "profile picture">
              </div>
            </div>
          </div>
          <div class="flex-item-wrapper">
            <p class="description">我が名はカセイ</p>
            <hr>
           <div class="location-wrapper">
             <p class="location"><span class="glyphicon glyphicon-map-marker"></span> Singapore</p>
           </div>
           <hr>
           <div class="social-wrapper">
             
             <a href="https://github.com/huashengwang1989/" target="_blank">
              <svg class="glyphicon glyphicon-ant-github" alt="GitHub Icon" ><use xlink:href="/icon/ant-github.svg#si-ant-github"></use></svg>
            </a>
            
           </div>
         </div>
       </div>

    </div>

  
    
    
    <div class="widget-wrapper menu-widget">

        <div class="widget-container">
          <div class="menu-wrapper">
            <nav class="nav">
                
                    <div class="nav-item">
                      <a href="/">Home</a>
                    </div>
                
                    <div class="nav-item">
                      <a href="/archives">Archives</a>
                    </div>
                
            </nav>
          </div>
         </div>
    </div>

  
    
    

  
</div>

          </div>


          <div id="page-container-wrapper">

            <div id="page-container">
                <!-- Blog Header: title and subtitle -->
                <div id="header-wrapper">
                  <div class="blog-header">
    <h1 class="blog-title">
      <a href="/">カセイちゃんの動物園</a>
    </h1>
    <p class="lead blog-description">A random blog to record tech ideas</p>
</div>

                </div>

                <!-- Main Content -->
                <div id="page-content-wrapper">
                  <div class="page-content">
                      <div class="row">
                          <div class="blog-entry">
                              <div class="blog-post full-article">
    <!-- Title -->
    <div class="blog-header">
      <h2 class="blog-post-title">
            Element-UI El-Table: Problem With Expandable Rows Being Used Together With Fixed Columns
      </h2>
      <!-- Date and Author -->
      <div class="blog-post-meta">
          <span class="blog-date">2017-08-13</span>
          
      </div>
      <!-- Tags and Categories links -->
      <div class="blog-post-additional">
        <span class="blog-tags">

<div class="blog-tags-container">
    <span class="glyphicon glyphicon-tags"></span>
    <a href="/tags/vue/">Vue</a> <a href="/tags/element-ui/">Element UI</a>
</div>

</span>
        <span class="blog-cats">
</span>
      </div>
    </div>

    <!-- Content -->
    <div class="blog-content-wrapper">
        <div class="blog-content">
        <p>The Table component from <a href="http://element.eleme.io" target="_blank" rel="noopener">Element</a>  (<code>el-table</code>) is very versatile in displaying tabulated data, with advanced functions such as fixed columns and expandable rows. However, the two don’t seem work well together.</p>
<a id="more"></a>
<h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h3><p>When a row is expanded, the expanded area takes the width of the whole table content, including the width of the columns partially or fully hidden behind the fixed columns, if the table is too wide for the screen. More over, if contents like a paragraph is displayed, the “head” and “tail” of each row will be fixed inside the fixed columns, whereas you have to scroll left and right to view the majority of the content. I am not sure whether there is any use case for this; but personally I think that it will make more sense if the expanded area is not affected by the fixed columns, taking the width of the actual el-table DOM element, and always display above other elements/ (/i.e./ the borders of the fixed columns should not cut through the expanded area).</p>
<p>By analyzing the compiled HTML, I realized that the <code>el-table</code> realizes the fixed columns by duplicating the whole table body. If you have columns fixed at both left and right sides, the table will be duplicated for three times: one for the fixed columns on the left side, one for the main table contents, and one for the fixed columns on the right side. Unused columns for the <code>&lt;table&gt;</code> used for fixed columns are given a <code>is-hidden</code> class attribute. This is a genius but a rather expensive operation though.</p>
<p>Unsurprisingly, the expanded rows are also duplicated three times in the case with fixed columns at both sides. It is indeed a <code>&lt;td&gt;</code> element with <code>colspan</code> equal to the total number of columns.  That explains why one expanded row is shown up at 3 places.</p>
<p>I would like to solve this problem (at least making it suitable for my use case) and try not to directly modifying the source code for <code>el-table</code> (as a beginner, I have no confidence of doing so).</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>Eventually, I managed to have some way to work around it. This is not a perfect way though.</p>
<p>What I need to do includes the following:</p>
<ul>
<li>Try to bring the expanded areas to top levels without being blocked by the fixed columns (directly manipulating <code>z-index</code>?)</li>
<li>Let the width of the expanded area be the same as the <code>el-table</code> <code>&lt;div&gt;</code>.</li>
</ul>
<p>The manipulating of <code>z-index</code> works (I simply set it to 999 for demo purpose, and this should work for most cases and will not obstruct is a modal is applied, /e.g./, where there is a Dialog triggered); but getting the correct width is not easy. The use of <code>&lt;td&gt;</code> inside a <code>&lt;table&gt;</code> making it rather difficult to manipulating the width of that <code>&lt;td&gt;</code> alone without affecting other elements inside this <code>&lt;table&gt;</code> (or rather, these three <code>&lt;table&gt;</code> elements).</p>
<p>I have to think of a workaround. Instead of manipulating the <code>&lt;td&gt;</code> itself, it would be easier if I create a wrapper <code>&lt;div&gt;</code> inside the <code>&lt;td&gt;</code>, and do everything to the wrapper <code>&lt;div&gt;</code>. In this way, I only need do the following to the CSS of the <code>&lt;td&gt;</code> of the expanded row:</p>
<pre><code>.el-table__expanded-cell {
	z-index: 999;
	padding: 0;
}</code></pre>
<p>The <code>z-index</code> is what I have mentioned just now to bring it to front; I also override the <code>padding</code>, as originally, it have a default <code>padding: 20px 50px</code>. I would rather control it in my wrapper later.</p>
<p>Now we have yet to deal with the width. You will notice that the expanded area are too wide, which you may have to scroll left and right to pan through rows of contents. Since the content is now inside the wrapper (here I name it <code>expand-area-wrapper</code>), I just need assign a width to the wrapper. As I have set the <code>padding</code> of <code>.el-table__expanded-cell</code> to 0, I simply need make it equal to the<code>clientWidth</code> of  <code>el-table</code> <code>&lt;div&gt;</code>.</p>
<p>To achieve this, I need know whether there is a row expanded, what rows are expanded /etc./ Therefore, in <code>&lt;el-table&gt;</code>, I have included the following:</p>
<pre><code>:data=&quot;tableData&quot;
:row-key=&quot;getRowKeys&quot;
:expand-row-keys=&quot;expands&quot;
@expand=&quot;handleExpand&quot;
</code></pre><p>The <code>tableData</code> is the data Array I feed to the <code>el-table</code>. <code>getRowKeys</code> is a function to return the <code>key</code> of the row with the input of a row, where each element in <code>tableData</code> is an Object of the row.</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">getRowKeys <span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> row<span class="token punctuation">.</span>key
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>I have a <code>key</code> prop assigned to each <code>row</code> as a unique identifier of  rows. You may use another property, as long as it is unique to each row.</p>
<p>The <code>expands</code> is an Array to hold the keys to the rows that are expanded.</p>
<p>However, the prop <code>expand-row-keys</code> is only useful to display the expanded rows based on its value <code>expands</code> at initialization. Any show / hide of expanded rows thereafter will not have any effect to <code>expands</code>. Therefore, we need manually update the <code>expands</code> in <code>handleExpand</code> method.</p>
<p>The <code>expand</code> event passes two arguments: <code>row</code>, and the expand status of that <code>row</code>. If it is now expanded, <code>expanded</code> is <code>true</code>, and vice versa.</p>
<p>Here is the <code>handleExpand</code> method for <code>expand</code> event:</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">handleExpand <span class="token punctuation">(</span>row<span class="token punctuation">,</span> expanded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>expanded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>key<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>When adding a new <code>row.key</code> to <code>expands</code>, it is recommended to check duplication, as in rare cases, duplicates may occur, which will result in bizarre behavior of the table.</p>
<p>Now we are ready to tackle the problem of the width. As the number of expanded rows changes at the time when an <code>expand</code> event is triggered, we can do it in <code>handleExpand</code> method.</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">handleExpand <span class="token punctuation">(</span>row<span class="token punctuation">,</span> expanded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span> <span class="token comment" spellcheck="true">// continue from previous code block</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> elems <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'el-table__expanded-cell'</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> elem <span class="token keyword">of</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                elem<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>demo2<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>clientWidth <span class="token operator">+</span> <span class="token string">'px'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Vue <code>$nextTick</code> is necessary as we need do it asynchronously.  We get the DOM elements of class  <code>el-table__expanded-cell</code>, and select its <code>firstChild</code> (or you can do it via its class name <code>expand-area-wrapper</code>. As this is a customized wrapper <code>div</code> , you may have a different class name.)  Please note that the value returned by <code>getElementsByClassName</code> is an <code>HTMLCollection</code>, and you need use <code>Array.from</code> to make it an array. Then you are able to set the width of the wrapper <code>div</code> based on the <code>clientWidth</code> of <code>el-table</code> (I added a <code>ref</code> to <code>el-table</code> named “demo2”, so that I can reference it via <code>$refs.demo2</code> in the code).</p>
<p>Manipulating the width itself is not sufficient. For now, the wrapper <code>div</code> will always stay at the very left. You can add a padding to the wrapper so that the contents inside will look normal though:</p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.el-table__expanded-cell</span> <span class="token class">.expand-area-wrapper</span> </span><span class="token punctuation">{</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">20</span>px <span class="token number">50</span>px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>However, in the case of a horizontal scroll bar appears, the wrapper <code>div</code> will move together with its parent (In fact, it’s the first <code>el-table__body-wrapper</code>). We can apply a margin to the left, but it needs change dynamically with the scrollbar position. Therefore, we need add a listener to it.</p>
<p>To make life easier, I created a <code>computed</code> variable for the DOM element where the scrollbar applies:</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    scrollTargetElem<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> targetTable <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>demo2
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loaded <span class="token operator">&amp;&amp;</span> targetTable<span class="token punctuation">)</span>
            <span class="token keyword">return</span> targetTable<span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'el-table__body-wrapper'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>In methods, I have the following listener:</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">scrollEventHandler <span class="token punctuation">(</span>ev<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollTargetElem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> elems <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollTargetElem<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'el-table__expanded-cell'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> elem <span class="token keyword">of</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            elem<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>style<span class="token punctuation">.</span>marginLeft <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollTargetElem<span class="token punctuation">.</span>scrollLeft <span class="token operator">+</span> <span class="token string">'px'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>The listener needs to be added or removed when there is an <code>expand</code> event. Therefore for the <code>handleExpand</code> method:</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">handleExpand <span class="token punctuation">(</span>row<span class="token punctuation">,</span> expanded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>expanded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollTargetElem
        <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> elems <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'el-table__expanded-cell'</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> elem <span class="token keyword">of</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    elem<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>demo2<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>clientWidth <span class="token operator">+</span> <span class="token string">'px'</span>
                    elem<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>style<span class="token punctuation">.</span>marginLeft <span class="token operator">=</span> target<span class="token punctuation">.</span>scrollLeft <span class="token operator">+</span> <span class="token string">'px'</span>
              <span class="token punctuation">}</span>
              target<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollEventHandler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                target<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollEventHandler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>In short, the following has been added to <code>handleExpand</code>:</p>
<ul>
<li>Initialize the <code>margin-left</code> for the wrapper <code>div</code>:</li>
</ul>
<pre class="line-numbers language-javascript"><code class="language-javascript">elem<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>style<span class="token punctuation">.</span>marginLeft <span class="token operator">=</span> target<span class="token punctuation">.</span>scrollLeft <span class="token operator">+</span> <span class="token string">'px'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>Add and remove the listeners depending on whether there are any expanded rows (<code>expands.length</code>).</li>
</ul>
<p>Where for the <code>scrollEventHandler</code> :</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">scrollEventHandler <span class="token punctuation">(</span>ev<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollTargetElem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> elems <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollTargetElem<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'el-table__expanded-cell'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> elem <span class="token keyword">of</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            elem<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>style<span class="token punctuation">.</span>marginLeft <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollTargetElem<span class="token punctuation">.</span>scrollLeft <span class="token operator">+</span> <span class="token string">'px'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Till now, most problems are solved. There is only one issue. If your table is not set as fixed width (/e.g./ <code>style=&quot;width: 100%;&quot;</code>), when your browser window is resized, the wrapper <code>div</code> width needs change as well, but there is no watcher on the window resize event.</p>
<p>I imported <a href="https://www.npmjs.com/package/vue-resize-directive" target="_blank" rel="noopener">vue-resize-directive</a> as a directive, and created the following <code>onResize</code> method:</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">onResize <span class="token punctuation">(</span>ev<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>expands<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> elems <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'el-table__expanded-cell'</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> width <span class="token operator">=</span> ev<span class="token punctuation">.</span>clientWidth
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> elem <span class="token keyword">of</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            elem<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> width <span class="token operator">+</span> <span class="token string">'px'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>In <code>&lt;el-table&gt;</code>, add the following:</p>
<pre><code>v-resize.debounce=&quot;onResize&quot;
</code></pre><p>Now the problem solved, though it is not a perfect solution.  Here is the JSFiddle for it:</p>
<iframe scrolling="no" width="100%" height="300" src="//jsfiddle.net/d004x3pf/embedded/js,resources,html,css,result/light" frameborder="0" allowfullscreen></iframe>

      </div>
    </div>

</div>


                          </div>
                       </div>
                    </div>
                </div>

              </div>

              <!-- Footer -->
              <footer class="blog-footer">
    <p>2017 &copy; Kasei. Template built based on <a href="http://getbootstrap.com">Bootstrap</a>.</p>
</footer>

              <!-- After footer scripts -->
              <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="/bootstrap/js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="/js/ie10-viewport-bug-workaround.js"></script>



            </div>
          </div>

      </div>

  </body>

</html>
